<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model Comparison - Multi-Theme UI</title>
	<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src {{cspSource}} 'unsafe-inline'; script-src {{cspSource}} 'unsafe-inline';">
	<script type="module" src="{{TOOLKIT_URI}}"></script>
	<link rel="stylesheet" href="{{STYLE_URI}}">
    <style>
        /* Base styles and CSS variables */
        :root {
            --transition-speed: 0.3s;
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        /* Flashy Theme (Default) */
        :root[data-theme="flashy"] {
            --primary-color: #007acc;
            --secondary-color: #0e639c;
            --accent-color: #ff6b35;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --border-radius: 12px;
            --border-style: none;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --header-gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --card-padding: 25px;
            --animation-enabled: 1;
        }

        /* Minimal Theme */
        :root[data-theme="minimal"] {
            --primary-color: #333333;
            --secondary-color: #666666;
            --accent-color: #000000;
            --success-color: #333333;
            --warning-color: #666666;
            --danger-color: #000000;
            --bg-color: #ffffff;
            --card-bg: transparent;
            --text-color: #000000;
            --border-color: #333333;
            --border-radius: 0;
            --border-style: 2px solid var(--border-color);
            --box-shadow: none;
            --header-gradient: none;
            --card-padding: 20px;
            --animation-enabled: 0;
        }

        /* Professional Theme */
        :root[data-theme="professional"] {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --bg-color: #ecf0f1;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --border-color: #bdc3c7;
            --border-radius: 4px;
            --border-style: 1px solid var(--border-color);
            --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            --header-gradient: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            --card-padding: 20px;
            --animation-enabled: 0.5;
        }

        /* Dark Theme */
        :root[data-theme="dark"] {
            --primary-color: #00d4ff;
            --secondary-color: #ff00ff;
            --accent-color: #00ff88;
            --success-color: #00ff88;
            --warning-color: #ffaa00;
            --danger-color: #ff0055;
            --bg-color: #0a0a0a;
            --card-bg: #1a1a1a;
            --text-color: #e0e0e0;
            --border-color: #333333;
            --border-radius: 8px;
            --border-style: 1px solid var(--accent-color);
            --box-shadow: 0 0 20px rgba(0, 212, 255, 0.1);
            --header-gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --card-padding: 22px;
            --animation-enabled: 1;
        }

        /* Global Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-family);
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all var(--transition-speed) ease;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: var(--header-gradient);
            border-radius: var(--border-radius);
            border: var(--border-style);
            box-shadow: var(--box-shadow);
            transition: all var(--transition-speed) ease;
        }

        :root[data-theme="minimal"] .header {
            background: var(--bg-color);
            color: var(--text-color);
        }

        :root[data-theme="flashy"] .header,
        :root[data-theme="dark"] .header {
            color: white;
        }

        :root[data-theme="professional"] .header {
            color: white;
        }

        .header h1 {
            font-size: 2.2em;
            font-weight: 300;
            margin-bottom: 10px;
            opacity: calc(0.7 + 0.3 * var(--animation-enabled));
        }

        /* Analysis Section */
        .analysis-section {
            background: var(--card-bg);
            border: var(--border-style);
            border-radius: var(--border-radius);
            padding: var(--card-padding);
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
            transition: all var(--transition-speed) ease;
        }

        .analysis-section h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .summary-box {
            background: var(--bg-color);
            border-left: 4px solid var(--primary-color);
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: calc(var(--border-radius) / 2);
        }

        :root[data-theme="minimal"] .summary-box {
            border: var(--border-style);
            border-left: 4px solid var(--primary-color);
        }

        /* Model Cards */
        .comparison-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .model-card {
            background: var(--card-bg);
            border: var(--border-style);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: all var(--transition-speed) ease;
        }

        :root[data-theme="flashy"] .model-card:hover,
        :root[data-theme="dark"] .model-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .model-header {
            padding: 20px;
            background: var(--header-gradient);
            border-bottom: var(--border-style);
        }

        :root[data-theme="minimal"] .model-header {
            background: transparent;
            color: var(--text-color);
        }

        :root[data-theme="flashy"] .model-header,
        :root[data-theme="dark"] .model-header,
        :root[data-theme="professional"] .model-header {
            color: white;
        }

        .model-content {
            padding: var(--card-padding);
        }

        .response-text {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: calc(var(--border-radius) / 2);
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Tags */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .tag {
            padding: 6px 12px;
            border-radius: calc(var(--border-radius) * 2);
            font-size: 0.85em;
            font-weight: 500;
            transition: all var(--transition-speed) ease;
        }

        :root[data-theme="minimal"] .tag {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 0;
        }

        :root[data-theme="flashy"] .tag.common,
        :root[data-theme="professional"] .tag.common,
        :root[data-theme="dark"] .tag.common {
            background: var(--success-color);
            color: white;
        }

        :root[data-theme="flashy"] .tag.unique,
        :root[data-theme="professional"] .tag.unique,
        :root[data-theme="dark"] .tag.unique {
            background: var(--accent-color);
            color: white;
        }

        /* Theme Switcher */
        .theme-switcher {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card-bg);
            border: var(--border-style);
            border-radius: var(--border-radius);
            padding: 10px;
            box-shadow: var(--box-shadow);
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .theme-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            border-radius: calc(var(--border-radius) / 2);
            background: var(--bg-color);
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-size: 0.9em;
        }

        .theme-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .theme-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn calc(0.5s * var(--animation-enabled)) ease-in;
        }

        /* Loading State */
        .loading-spinner {
            text-align: center;
            padding: 40px;
            font-size: 1.1em;
            color: var(--text-color);
            opacity: 0.7;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-color);
            opacity: 0.7;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: calc(var(--border-radius) / 2);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: calc(var(--border-radius) / 2);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .comparison-container {
                grid-template-columns: 1fr;
            }
            
            .theme-switcher {
                bottom: 10px;
                right: 10px;
                left: 10px;
                justify-content: center;
            }

            body {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Model Comparison Dashboard</h1>
        <p>Intelligent analysis and comparison across multiple language models</p>
    </div>

    <div id="analysisSection" class="analysis-section fade-in">
        <h2>Analysis Summary</h2>
        <div id="summaryContent" class="summary-box">
            Analyzing responses from multiple models...
        </div>
        
        <div id="commonElements">
            <h3>Common Elements</h3>
            <div id="commonTags" class="tags-container">
                <span class="tag common">Shared Concept 1</span>
                <span class="tag common">Shared Concept 2</span>
                <span class="tag common">Shared Concept 3</span>
            </div>
        </div>

        <div id="differences">
            <h3>Key Differences</h3>
            <div id="differencesGrid" class="tags-container">
                <span class="tag unique">Model A Unique</span>
                <span class="tag unique">Model B Unique</span>
            </div>
        </div>
    </div>

    <div id="results" class="comparison-container">
        <!-- Example Model Cards -->
        <div class="model-card fade-in">
            <div class="model-header">
                <h2>Model A</h2>
            </div>
            <div class="model-content">
                <div class="response-text">
This is a sample response from Model A.
It demonstrates how the text would appear
in different theme styles.

The response can contain code, explanations,
and various formatting elements.
                </div>
                <div class="stats-bar" style="margin-top: 15px; padding-top: 10px; border-top: 1px solid var(--border-color); font-size: 0.85em; opacity: 0.7;">
                    📊 42 words • 256 characters
                </div>
            </div>
        </div>

        <div class="model-card fade-in">
            <div class="model-header">
                <h2>Model B</h2>
            </div>
            <div class="model-content">
                <div class="response-text">
This is a sample response from Model B.
It shows different content and formatting
compared to Model A.

Each model's response is displayed
in its own card for easy comparison.
                </div>
                <div class="stats-bar" style="margin-top: 15px; padding-top: 10px; border-top: 1px solid var(--border-color); font-size: 0.85em; opacity: 0.7;">
                    📊 38 words • 241 characters
                </div>
            </div>
        </div>
    </div>

    <!-- Theme Switcher -->
    <div class="theme-switcher">
        <button class="theme-btn active" data-theme="flashy">✨ Flashy</button>
        <button class="theme-btn" data-theme="minimal">⬜ Minimal</button>
        <button class="theme-btn" data-theme="professional">💼 Professional</button>
        <button class="theme-btn" data-theme="dark">🌙 Dark</button>
    </div>

	<script src="{{SCRIPT_URI}}"></script>
    <script>
        // Theme Management
        class ThemeManager {
            constructor() {
                this.currentTheme = localStorage.getItem('model-comparison-theme') || 'flashy';
                this.init();
            }

            init() {
                // Apply saved theme
                this.applyTheme(this.currentTheme);
                
                // Setup theme switcher buttons
                this.setupThemeSwitcher();
                
                // Setup message listeners for cross-frame communication
                this.setupMessageListeners();
            }

            applyTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                this.currentTheme = theme;
                localStorage.setItem('model-comparison-theme', theme);
                
                // Update active button
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.theme === theme);
                });
                
                // Notify parent frame if embedded
                if (window.parent !== window) {
                    window.parent.postMessage({
                        type: 'THEME_CHANGED',
                        payload: { theme },
                        source: 'comparison-ui'
                    }, '*');
                }
            }

            setupThemeSwitcher() {
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.applyTheme(btn.dataset.theme);
                    });
                });
            }

            setupMessageListeners() {
                window.addEventListener('message', (event) => {
                    // Validate message origin if needed
                    const message = event.data;
                    
                    switch (message.type) {
                        case 'UPDATE_DATA':
                            this.updateComparisonData(message.payload);
                            break;
                        case 'CHANGE_THEME':
                            this.applyTheme(message.payload.theme);
                            break;
                        case 'REQUEST_STATE':
                            this.sendCurrentState();
                            break;
                    }
                });
                
                // Notify parent that UI is ready
                if (window.parent !== window) {
                    window.parent.postMessage({
                        type: 'READY',
                        source: 'comparison-ui'
                    }, '*');
                }
            }

            updateComparisonData(data) {
                // Update the UI with new comparison data
                if (data.analysis) {
                    this.updateAnalysis(data.analysis);
                }
                if (data.data) {
                    this.updateModelResponses(data.data);
                }
            }

            updateAnalysis(analysis) {
                // Update summary
                const summaryEl = document.getElementById('summaryContent');
                if (summaryEl && analysis.summary) {
                    summaryEl.textContent = analysis.summary;
                }
                
                // Update common elements
                const commonTagsEl = document.getElementById('commonTags');
                if (commonTagsEl && analysis.commonElements) {
                    commonTagsEl.innerHTML = '';
                    analysis.commonElements.forEach(element => {
                        const tag = document.createElement('span');
                        tag.className = 'tag common';
                        tag.textContent = element;
                        commonTagsEl.appendChild(tag);
                    });
                }
                
                // Update differences
                const differencesEl = document.getElementById('differencesGrid');
                if (differencesEl && analysis.differences) {
                    differencesEl.innerHTML = '';
                    Object.entries(analysis.differences).forEach(([model, diffs]) => {
                        diffs.forEach(diff => {
                            const tag = document.createElement('span');
                            tag.className = 'tag unique';
                            tag.textContent = `${model}: ${diff}`;
                            differencesEl.appendChild(tag);
                        });
                    });
                }
            }

            updateModelResponses(data) {
                const resultsEl = document.getElementById('results');
                if (!resultsEl) return;
                
                resultsEl.innerHTML = '';
                
                Object.entries(data).forEach(([modelId, response], index) => {
                    const card = this.createModelCard(modelId, response, index);
                    resultsEl.appendChild(card);
                });
            }

            createModelCard(modelId, response, index) {
                const card = document.createElement('div');
                card.className = 'model-card fade-in';
                card.style.animationDelay = `${index * 0.1}s`;
                
                const wordCount = response.split(/\s+/).filter(w => w.length > 0).length;
                const charCount = response.length;
                
                card.innerHTML = `
                    <div class="model-header">
                        <h2>${modelId}</h2>
                    </div>
                    <div class="model-content">
                        <div class="response-text">${this.escapeHtml(response)}</div>
                        <div class="stats-bar" style="margin-top: 15px; padding-top: 10px; border-top: 1px solid var(--border-color); font-size: 0.85em; opacity: 0.7;">
                            📊 ${wordCount} words • ${charCount} characters
                        </div>
                    </div>
                `;
                
                return card;
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            sendCurrentState() {
                if (window.parent !== window) {
                    window.parent.postMessage({
                        type: 'STATE_UPDATE',
                        payload: {
                            theme: this.currentTheme,
                            ready: true
                        },
                        source: 'comparison-ui'
                    }, '*');
                }
            }
        }

        // Initialize theme manager when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => new ThemeManager());
        } else {
            new ThemeManager();
        }
    </script>
</body>
</html>